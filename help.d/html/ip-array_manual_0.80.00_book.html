<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>IP-Array 0.80.00 Reference Manual</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.74.3-pre"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="book" lang="en"><div class="titlepage"><div><div><h1 class="title"><a name="d0e2"></a>IP-Array 0.80.00 Reference Manual</h1></div><div><div class="author"><h3 class="author"><span class="firstname">AllKind</span> <span class="surname"></span></h3><div class="affiliation"><span class="orgname">AllKind<br></span></div></div></div><div><p class="copyright">Copyright &copy; 2009 AllKind </p></div><div><div class="legalnotice"><a name="d0e16"></a><p>GPL v.2+</p></div></div><div><p class="pubdate">2009</p></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="chapter"><a href="#intro">1. Introduction</a></span></dt><dd><dl><dt><span class="section"><a href="#about_doc">About this document</a></span></dt><dt><span class="section"><a href="#about_ip-array">About IP-Array</a></span></dt><dd><dl><dt><span class="section"><a href="#whatis_ip-array">What is IP-Array?</a></span></dt><dt><span class="section"><a href="#requirements">Requirements</a></span></dt><dt><span class="section"><a href="#goals">Goals</a></span></dt><dt><span class="section"><a href="#features">Features</a></span></dt><dt><span class="section"><a href="#download_info">Where to find IP-Array?</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#gen_info">2. General Information</a></span></dt><dd><dl><dt><span class="section"><a href="#name_conv">Naming conventions</a></span></dt><dt><span class="section"><a href="#prog_logic">Program logic</a></span></dt><dd><dl><dt><span class="section"><a href="#start_behav">Starting behaviour</a></span></dt><dt><span class="section"><a href="#error_handling">Error handling</a></span></dt><dt><span class="section"><a href="#config_validation">Configuration validation</a></span></dt><dt><span class="section"><a href="#configfile_parsing">XML configuration file parsing</a></span></dt><dt><span class="section"><a href="#iface_chains">Per interface chain creation</a></span></dt><dt><span class="section"><a href="#routing">Routing</a></span></dt></dl></dd><dt><span class="section"><a href="#dir_struct">Directory structure</a></span></dt></dl></dd><dt><span class="chapter"><a href="#install">3. Installation</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e814"></a></span></dt><dt><span class="section"><a href="#d0e817"></a></span></dt></dl></dd><dt><span class="chapter"><a href="#configure">4. Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#config_files">Configuration files</a></span></dt><dd><dl><dt><span class="section"><a href="#config_files_bash">Bash</a></span></dt><dt><span class="section"><a href="#config_files_xml">XML</a></span></dt></dl></dd><dt><span class="section"><a href="#conf_xml_templates_howto">Templates</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e2868">Syntax</a></span></dt><dt><span class="section"><a href="#d0e2872">Template XML elements</a></span></dt><dt><span class="section"><a href="#d0e2946">Template usage guidelines</a></span></dt></dl></dd><dt><span class="section"><a href="#conf_xml_ruleblocks_howto">Ruleblocks</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e2956">Syntax</a></span></dt><dt><span class="section"><a href="#d0e2960">Ruleblock XML elements</a></span></dt><dt><span class="section"><a href="#d0e2964">Ruleblocks usage guidelines</a></span></dt></dl></dd><dt><span class="section"><a href="#conf_xml_rule_files_howto">Rule files</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e2974">Syntax</a></span></dt><dt><span class="section"><a href="#d0e2978">Rule file XML elements</a></span></dt><dt><span class="section"><a href="#pub_funcs">Public functions</a></span></dt><dt><span class="section"><a href="#inline_funcs">inline functions</a></span></dt><dt><span class="section"><a href="#d0e3296">Rulefile usage guidelines</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#usage">5. Usage</a></span></dt><dd><dl><dt><span class="section"><a href="#startup_params">Startup parameters and options</a></span></dt><dd><dl><dt><span class="section"><a href="#usage_params">Parameters</a></span></dt><dt><span class="section"><a href="#usage_options">Options</a></span></dt></dl></dd><dt><span class="section"><a href="#startup_usage_examples">Usage examples</a></span></dt></dl></dd><dt><span class="chapter"><a href="#examples">6. Examples</a></span></dt><dd><dl><dt><span class="section"><a href="#example_single_host">Single host example</a></span></dt><dt><span class="section"><a href="#example_lan_gatew">LAN gateway example</a></span></dt><dt><span class="section"><a href="#example_multi_home">Multi-homed example</a></span></dt></dl></dd><dt><span class="chapter"><a href="#faq">7. FAQ</a></span></dt><dt><span class="chapter"><a href="#appendix">8. Appendix</a></span></dt><dd><dl><dt><span class="section"><a href="#support_info">Support</a></span></dt><dt><span class="section"><a href="#bug_report">Bug report</a></span></dt><dt><span class="section"><a href="#co-develop">Co-Development</a></span></dt></dl></dd></dl></div><div class="list-of-tables"><p><b>List of Tables</b></p><dl><dt>2.1. <a href="#d0e555">Example of Template and Ruleblock relationship</a></dt><dt>4.1. <a href="#d0e2498">Configure networking interfaces</a></dt><dt>4.2. <a href="#d0e2581">Local (LAN) name servers</a></dt><dt>4.3. <a href="#d0e2620">ISP name servers</a></dt><dt>4.4. <a href="#d0e2662">Local name servers (resolv.conf)</a></dt><dt>4.5. <a href="#d0e2694">ISP SMTP servers</a></dt><dt>4.6. <a href="#d0e2740">Local NTP servers</a></dt><dt>4.7. <a href="#d0e2786">VPN_MAP structure</a></dt></dl></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="intro"></a>Chapter&nbsp;1.&nbsp;Introduction</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#about_doc">About this document</a></span></dt><dt><span class="section"><a href="#about_ip-array">About IP-Array</a></span></dt><dd><dl><dt><span class="section"><a href="#whatis_ip-array">What is IP-Array?</a></span></dt><dt><span class="section"><a href="#requirements">Requirements</a></span></dt><dt><span class="section"><a href="#goals">Goals</a></span></dt><dt><span class="section"><a href="#features">Features</a></span></dt><dt><span class="section"><a href="#download_info">Where to find IP-Array?</a></span></dt></dl></dd></dl></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="about_doc"></a>About this document</h2></div></div></div><p>This document is the <span class="bold"><strong>reference manual</strong></span> for <span class="bold"><strong>IP-Array version 0.80.00</strong></span>.</p><p>It should provide all the information necessary to configure and use IP-Array.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="about_ip-array"></a>About IP-Array</h2></div></div></div><p>This section provides an overview about what IP-Array is, the requirements, features,
        goals and online availability.</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="whatis_ip-array"></a>What is IP-Array?</h3></div></div></div><p>IP-Array is a command-line program (you may also say `script') written in <span class="bold"><strong>bash</strong></span>.</p><p>It's purpose is to configure <span class="bold"><strong>IPv4</strong></span>
          <span class="bold"><strong>firewalling</strong></span> and <span class="bold"><strong>traffic
            shaping</strong></span> of a linux host.</p><p>To achieve this, IP-Array <span class="bold"><strong>configures</strong></span> the kernels
            <span class="bold"><strong>netfilter / traffic control</strong></span> subsystems via the
          userspace tools<span class="bold"><strong> iptables / tc</strong></span>.</p><p>It also allows to <span class="bold"><strong>load and / or unload</strong></span> netfilter
          related <span class="bold"><strong>kernel</strong></span>
          <span class="bold"><strong>modules</strong></span> and <span class="bold"><strong>configure</strong></span>
          the kernel via the <span class="bold"><strong>`/proc' filesystem</strong></span>.</p><p><span class="bold"><strong>Intended Audience:</strong></span> Advanced End Users, System
          Administrators.</p><p><span class="bold"><strong>Field of application:</strong></span> From single host system to
          multi-homed router / gateway.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="requirements"></a>Requirements</h3></div></div></div><p>This list describes, what is necessary to use IP-Array:</p><p>
          </p><div class="itemizedlist"><ul type="disc"><li><p>Bash version 3.0 or higher</p></li><li><p>Linux kernel 2.4 or higher</p></li><li><p>Netfilter support enabled in the kernel</p></li><li><p>Traffic control support enabled in the kernel (optional)</p><p>To enable traffic shaping.</p></li><li><p>Some coreutils:</p><div class="itemizedlist"><ul type="circle"><li><p><span class="command"><strong>cat</strong></span></p></li><li><p><span class="command"><strong>date</strong></span></p></li><li><p><span class="command"><strong>grep</strong></span></p></li><li><p><span class="command"><strong>mkdir</strong></span></p></li><li><p><span class="command"><strong>rm</strong></span></p></li><li><p><span class="command"><strong>seq</strong></span></p></li><li><p><span class="command"><strong>uname</strong></span></p></li></ul></div></li><li><p>The <span class="command"><strong>iptables</strong></span> program.</p></li><li><p>The <span class="command"><strong>iproute2</strong></span> program (ip)</p></li><li><p>The <span class="command"><strong>lsmod</strong></span> and <span class="command"><strong>modprobe</strong></span> programs</p><p>Required if IP-Array is configured to load and/or unload modules.</p></li><li><p>The <span class="command"><strong>tc</strong></span> program (optional)</p><p>To enable traffic shaping.</p></li><li><p>The <span class="command"><strong>logger</strong></span> utility (optional)</p><p>To write messages to syslog.</p></li><li><p><span class="command"><strong>awk</strong></span> (only used with the `ROOT_DNS' option)</p><p>Any awk version should work, as only very basic operations are performed.</p></li><li><p>The <span class="command"><strong>at</strong></span> utility.</p></li><li><p>Decent understanding of the netfilter concept</p><p>Tables, chains (and their order of traversal).</p><p>State match (conntrack) functionality.</p></li><li><p>Decent understanding of the traffic control concept (optional)</p><p>Qdiscs (htb, sfq), classes, filters and how they work together.</p></li><li><p>Decent understanding of the `/proc' filesystems networking (netfilter) options
                (optional)</p></li></ul></div><p>
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="goals"></a>Goals</h3></div></div></div><div class="orderedlist"><ol type="1"><li><p>Provide a configuration interface to iptables and tc.</p></li><li><p>Allowing flexible configuration from simple to complex setups.</p></li><li><p>Keep effective rule writing effort low, by just entering the desired values.
              Keeping the the user away from the programs (i.e. iptables. tc,..) syntax.</p></li><li><p>Stay as close as possible with the concept and naming of iptables / tc.</p></li><li><p>Although (by now) it's not the main goal of IP-Array, provide some preset options
              for automatic configuration.</p></li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="features"></a>Features</h3></div></div></div><div class="orderedlist"><ol type="1"><li><p>Template based rule structure definition (quite a huge list of predifined
              templates is provided out of the box).</p></li><li><p>Avaliable iptables targets:</p><div class="itemizedlist"><ul type="disc"><li><p>ACCEPT</p></li><li><p>DROP</p></li><li><p>REJECT</p></li><li><p>LOG</p></li><li><p>DNAT</p></li><li><p>SNAT</p></li><li><p>MARK</p></li><li><p>RETURN</p></li><li><p>TTL (as public function)</p></li><li><p>TCPMSS (as configuration option in the main configuration file)</p></li><li><p>IP-Array supports <span class="bold"><strong>any target</strong></span> that has
                      <span class="bold"><strong>no options</strong></span>.</p></li><li><p><span class="bold"><strong>No Target</strong></span>. It is possible to create rules
                    without a target set, by specifying the target with the special string:
                      `<span class="bold"><strong>empty</strong></span>'.</p></li></ul></div></li><li><p>Avaliable iptables match extensions:</p><div class="itemizedlist"><ul type="disc"><li><p>state match</p></li><li><p>mac address match</p></li><li><p>limit match</p></li><li><p>iprange match</p></li><li><p>multiport match</p></li><li><p>tos match</p></li></ul></div></li><li><p>Definition of templates, ruleblocks and rule files is done in a simple XML
              dialect.</p></li><li><p>Traffic shaping capabilities:</p><div class="itemizedlist"><ul type="disc"><li><p>Marking of packets in mangle table</p></li><li><p>Creation of htb and sfq qdiscs</p></li><li><p>Creation of tc classes and filters</p></li><li><p>Bulk OUTPUT and FORWARD qdiscs</p></li><li><p>Prioryzing of SYN packets</p></li></ul></div></li><li><p>Automatic configuration (rule generation) options for:</p><div class="itemizedlist"><ul type="disc"><li><p>IPSEC (VPN)</p><p>Put all ipsec related traffic into the ipsec chain. Allow only packets from
                    / to the configured VPN branches.</p><p>An option is available to allow all traffic between the VPN branches.</p></li><li><p>DNS</p><div class="orderedlist"><ol type="a"><li><p>Allow local host DNS lookups to specific name servers.</p></li><li><p>Allow forwarded DNS lookups from specific LAN name servers to ISP name
                          servers.</p></li><li><p>Allow forwarded DNS lookups from specific LAN name servers to root
                          name servers.</p></li></ol></div></li><li><p>SMTP</p><p>Allow SMTP traffic from specific LAN(s) to ISP mail servers.</p></li><li><p>NTP</p><p>Allow time server queries from local host to specific NTP servers.</p></li><li><p>FTP</p><p>Allow forwarded (optional active/passive) FTP traffic from specific
                    LAN(s).</p></li><li><p>Windows and Real Media player</p><p>Allow Windows and/or Real media player traffic from certain LAN(s).</p></li><li><p>OUTPUT rule generation (bound to interfaces or primary IP addresses)</p></li><li><p>Final rule</p><p>A chain termination option for builtin and IP-Array created chains, which
                    allows to choose between different 'final rule' modes.</p></li></ul></div></li><li><p>Automated iptables logging options:</p><div class="itemizedlist"><ul type="disc"><li><p>Globally log fragments</p></li><li><p>Globally log invalid TCP packets</p></li><li><p>Globally log packets in INVALID state</p></li><li><p>Globally log port scans</p></li><li><p>Log options (prefix, level, etc.) for the above listed.</p></li></ul></div></li><li><p>Automated iptables dropping options:</p><div class="itemizedlist"><ul type="disc"><li><p>Globally drop fragments</p></li><li><p>Globally drop invalid TCP packets</p></li><li><p>Globally drop packets in INVALID state</p></li><li><p>Globally drop port scans</p></li><li><p>Reject AUTH (tcp port 113) on certain interfaces</p></li><li><p>Drop NETBIOS broadcasts on certain interfaces</p></li><li><p>Drop DHCP broadcasts on certain interfaces</p></li><li><p>Drop UPNP broadcasts on certain interfaces</p></li></ul></div></li><li><p>Prolog and Epilog scripts</p><p>Prolog and epilog scripts can be configured for any startup mode.</p></li><li><p>Loading and unloading of kernel modules (with optional parameters)</p></li><li><p>/proc filesystem configuration</p><p>There are many networking related options available in IP-Array, to configure the
              system using the /proc filesystem.</p></li><li><p>Saving restore rulesets / commands / system state</p><p>There are various ways available to save the generated rulesets and or commands
              selectivly (iptables, tc, modprobe, /proc) or all at once. The saved files may be used
              to restore the configured system state.</p></li><li><p>Different levels of IP-Array's output verbosity to the screen and or syslog can be
              set</p></li><li><p>Screen output can be colourized</p><p>Colours for different message categories can be defined by the user.</p></li><li><p>Public functions</p><p>IP-Array allows the usage of `public functions' in rule files. They may be used to
              log messages (giving the opportunity to totally customize IP-Array's log output) or
              call automatic rule creation functions.</p></li><li><p>Different startup behaviour according to command line parameter. Including
              multiple options to save and / or restore generated rulesets or commands.</p></li><li><p>A `test' mode to test new configurations</p></li><li><p>Automatic `jump tree' creation in all tables</p></li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="download_info"></a>Where to find IP-Array?</h3></div><div><h4 class="subtitle">Home page and download information</h4></div></div></div><p>IP-Array is currently hosted at <a class="link" href="http://sf.net" target="_top">sourceforge</a>.</p><p>The home page is reachable via: <a class="link" href="http://www.sf.net/projects/ip-array" target="_top">http://www.sf.net/projects/ip-array</a> or <a class="link" href="http://ip-array.sf.net/" target="_top">http://ip-array.sf.net/</a>.</p><p>IP-Array files are available for download at: <a class="link" href="http://sourceforge.net/project/showfiles.php?group_id=146101" target="_top">sf.net</a>.</p></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="gen_info"></a>Chapter&nbsp;2.&nbsp;General Information</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#name_conv">Naming conventions</a></span></dt><dt><span class="section"><a href="#prog_logic">Program logic</a></span></dt><dd><dl><dt><span class="section"><a href="#start_behav">Starting behaviour</a></span></dt><dt><span class="section"><a href="#error_handling">Error handling</a></span></dt><dt><span class="section"><a href="#config_validation">Configuration validation</a></span></dt><dt><span class="section"><a href="#configfile_parsing">XML configuration file parsing</a></span></dt><dt><span class="section"><a href="#iface_chains">Per interface chain creation</a></span></dt><dt><span class="section"><a href="#routing">Routing</a></span></dt></dl></dd><dt><span class="section"><a href="#dir_struct">Directory structure</a></span></dt></dl></div><p>This Chapter provides information about the structure, functionality and program logic of
      IP-Array.</p><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="name_conv"></a>Naming conventions</h2></div></div></div><div class="itemizedlist"><ul type="disc"><li><p><a name="name_def_rule"></a>rule</p><p>A rule is either:</p><div class="orderedlist"><ol type="1"><li><p>An entity in an iptables or tc <a class="link" href="#name_def_ruleblock">ruleblock</a>. Defined by the user or program logic. Which will be read by
                IP-Array, in order to create one or more iptables or tc commands.</p></li><li><p>An entity added by the `add_rule' function. Where the `add_rule' function may be
                used as `public function' or `inline function'. In order to create an iptables
                command.</p></li></ol></div></li><li><p><a name="name_def_ruleblock"></a>ruleblock</p><p>A ruleblock is a group of <a class="link" href="#name_def_rule">rules</a>, to be read in
            order of occurence.</p><p>The structure of the ruleblock is defined in a <a class="link" href="#name_def_template">template</a>.</p></li><li><p><a name="name_def_template"></a>template</p><p>A template describes the structure of a <a class="link" href="#name_def_ruleblock">ruleblock</a>.</p><p>Each <a class="link" href="#name_def_rule">rule</a> entry in a ruleblock is interpreted
            column-wise. How the values in each column are interpreted, is defined in the template
            called with the ruleblock.</p><p>The following example will show how a rule in a ruleblock , structured according to
            the definitions in a template, may look:</p><div class="table"><a name="d0e555"></a><p class="title"><b>Table&nbsp;2.1.&nbsp;Example of Template and Ruleblock relationship</b></p><div class="table-contents"><table summary="Example of Template and Ruleblock relationship" border="1"><colgroup><col><col><col><col><col></colgroup><tbody><tr><td align="left"><span class="bold"><strong>Template definition:</strong></span></td><td align="left">jump_target</td><td align="left">ipt_chain</td><td align="left">input_device</td><td align="left">source_address</td></tr><tr><td align="left"><span class="bold"><strong>According ruleblock rule:</strong></span></td><td align="left">DROP</td><td align="left">INPUT</td><td align="left">eth0</td><td align="left">10.0.0.10</td></tr></tbody></table></div></div><br class="table-break"></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="prog_logic"></a>Program logic</h2></div></div></div><p></p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="start_behav"></a>Starting behaviour</h3></div></div></div><p>If IP-Array is run with the `<span class="bold"><strong>start</strong></span>' parameter, a
          lockdown mode is enforced until configuration is read and all iptables rules have been
          generated. During this lockdown mode only localhost and the administrator connection are
          allowed. After all rules are collected, they are applied at once.</p><p>In any other mode, that actually runs commands to configure the system, IP-Array will
          not touch the currently active iptables, tc rules or /proc configuration until all rules
          and / or commands have been generated.</p><p>After all rules / commands are collected, they are applied at once. This should keep
          the time, the system is in an unconfigured or partly configured state, to a minimum.
          Allowing to catch configuration errors, before changing the systems state.</p><p>The behaviour for kernel modules is different. Module probing (if configured at all)
          is done every time IP-Array loads. To avoid reloading modules on an already running
          system, modules will only be loaded if they are not loaded already. If running in a mode
          that does not apply commands like i.e. `dry-run', then module probing is not actually
          perfomed, but done with `modprobe -n'.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="error_handling"></a>Error handling</h3></div></div></div><p>In the main configuration file a variable named <code class="varname">EXIT_ON_ERROR</code>
          exists to control IP-Arrays behaviour on errors. If it set to `1', the program will exit
          on any configuration and command apply error it can detect. In case the system state has
          already been changed by, either loading / unloading modules, or setting values in the
          /proc filesystem, IP-Array will try to revert those changes. If iptables commands have
          already been applied, a lockdown mode will be enforced. All policies will be set to DROP
          and all chains get emptied. Depending on the configuration, only the current
          administrative connection (if present taken from the bash environment variable
            <code class="varname">SSH_CONNECTION</code>, or if not, if configured from the configuration
          variable <code class="varname">ADMIN_CONNECTION</code>) and localhost traffic (configuration
          variable <code class="varname">ALLOW_LOOPBACK</code>) may be allowed. If
            <code class="varname">EXIT_ON_ERROR</code> is set to `0', IP-Array only sends error messages and
          keeps on going.</p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="autosave"></a>Autosave / restore</h4></div></div></div><p>If IP-Array is started with one of the following parameters: open, restart, or
            tc-start it will automatically save the current iptables ruleset using iptables-save to
            a temporary file. In case an error occurs while processing the configuration, this
            ruleset will be restored. This behaviour can be turned off, by using the startup option
              <span class="bold"><strong>-n | --no-autosave</strong></span>. If the configuration variable
              <code class="varname">IPTSAVE_FAILS</code> is set to `1' automatic saving / restoring will also
            not take place.</p><p>
            </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>The restore procedure may even occur after an error condition lockdown (as
                described above) was inforced. This is done as something could go wrong with the
                restore process. Better have a lockded down system than one with an unkown and most
                likely messed up state.</p></div><p>
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="exit_codes"></a>Exit codes</h4></div></div></div><p>
            </p><div class="itemizedlist"><ul type="disc"><li><p>0 - Success.</p></li><li><p>1 - Unknown error.</p></li><li><p>2 - Usage information (help).</p></li><li><p>111 - Not exist error. Used if i.e. a file was not found.</p></li><li><p>112 - Not defined error. Used if i.e. a configuration variable is not
                  set.</p></li><li><p>113 - Loading error. Used if i.e. sourcing a file failed.</p></li><li><p>114 - Failure error. General fail condition.</p></li><li><p>115 - Configuration error. Used if a configuration error was not found.</p></li></ul></div><p>
          </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="config_validation"></a>Configuration validation</h3></div></div></div><p>Every rule set by the user, will be validated for sane entries. For example IP
          addresses, port and protocol specifications, etc. are checked for valid values. If a bad
          value is detected, according messages will be displayed and the rule entry will be
          ignored. IP-Array may also quit further processing, if it is configured to exit on
          errors.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="configfile_parsing"></a>XML configuration file parsing</h3></div></div></div><p>As IP-Array starts, it looks if it can find previously already compiled bash scripts
          for templates, rules and ruleblocks. If those are found, they will be read and no XML file
          parsing will be done. Otherwise the XML configuration files will be interpreted and the
          according bash scripts will be compiled. There are startup parameters available to force
          XML parsing globally, or selectively for templates, rules and ruleblocks.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="iface_chains"></a>Per interface chain creation</h3></div></div></div><p></p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e684"></a>Forwarding interface classified chains</h4></div></div></div><p>IP-Array creates chains between every network interface configured in
            'NET_INTERFACES'. Means if you define two interfaces i.e: eth0 and eth1, IP-Array will
            create two chains named: 'eth0_to_eth1' and 'eth1_to_eth0'. And so on for every
            additional interface. This can done for the filter, mangle, nat and the raw table
            according to the configuration. In example for the filter table the FORWARD chain then
            is filled with jump entries, seeding out the cross-interface traffic to the appropriate
            chain. Means every packet entering the FORWARD chain will end up in one of those chains
            created by IP-Array. This should minimize the amount of rules to pass before reaching
            the matching rule. IP-Array always uses those cross-interface chains when it applies
            rules in the FORWARD chain. In case an interface alias i.e: 'eth+', or an inverted
            interface value i.e: '!eth0' is used, the target chain will be FORWARD, instead of the
            cross-interface chains.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e689"></a>Non-forwarding interface classified chains</h4></div></div></div><p>Just like with the cross-interface chains, INPUT and OUTPUT packets are also
            classified by interface. For each network interface configured, INPUT and OUTPUT chains
            will be created. For example if one interface named 'eth0' is present, the chains
            'INPUT_eth0', 'OUTPUT_eth0' and the according jump entries will be created and
            automatically.</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="routing"></a>Routing</h3></div></div></div><p>IP-Array does not touch your routing tables at all!</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dir_struct"></a>Directory structure</h2></div></div></div><p>This is the description of the dicretory structure IP-Array uses:</p><div class="variablelist"><dl><dt><span class="term">BASE_DIR</span></dt><dd><p>Base directory for IP-Array.</p><p>Default location of defaults directory, saving directory, help directory.</p><p>`stable' and `test' (OP_DIR) directory (describing runmode).</p><p>i.e. <code class="filename">`/usr/local/etc/ip-array/'</code></p></dd><dt><span class="term">BIN_DIR</span></dt><dd><p>Directory to put the main IP-Array executable into.</p><p>i.e. <code class="filename">`/usr/local/bin/ip-array/'</code></p></dd><dt><span class="term">LIB_DIR</span></dt><dd><p>Directory to put the IP-Array function files into.</p><p>i.e. <code class="filename">`/usr/local/lib/ip-array/'</code></p></dd><dt><span class="term">HELP_DIR</span></dt><dd><p>Directory containing help files.</p><p><code class="code">HELP_DIR="${BASE_DIR}/help.d"</code></p></dd><dt><span class="term">OP_DIR</span></dt><dd><p>Operation directory according to runmode. Can be either `stable' or `test' (if
              startup parameter `test' is used).</p><p><code class="code">OP_DIR="${BASE_DIR}/${rmode}"</code></p></dd><dt><span class="term">CONFIG_DIR</span></dt><dd><p>Directory containing configuration files and sub-directories.</p><p><code class="code">CONFIG_DIR="${OP_DIR}/conf.d"</code></p></dd><dt><span class="term">RULE_DIR</span></dt><dd><p>Directory to put the rule files into.</p><p><code class="code">RULE_DIR="${OP_DIR}/rules.d"</code></p></dd><dt><span class="term">SCRIPT_DIR</span></dt><dd><p>Directory for the prolog / epilog scripts.</p><p><code class="code">SCRIPT_DIR="${OP_DIR}/scripts.d"</code></p></dd><dt><span class="term">RULEBLOCK_DIR</span></dt><dd><p>Directory to put the ruleblock configuration files into.</p><p><code class="code">RULEBLOCK_DIR="${CONFIG_DIR}/ruleblocks.d"</code></p></dd><dt><span class="term">TEMPLATE_DIR</span></dt><dd><p>Directory to put the template configuration files into.</p><p><code class="code">TEMPLATE_DIR="${CONFIG_DIR}/templates.d"</code></p></dd><dt><span class="term">SAVE_DIR</span></dt><dd><p>Directory used to save commands, scripts or rulesets.</p><p><code class="code">SAVE_DIR="${BASE_DIR}/save"</code></p></dd></dl></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="install"></a>Chapter&nbsp;3.&nbsp;Installation</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#d0e814"></a></span></dt><dt><span class="section"><a href="#d0e817"></a></span></dt></dl></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e814"></a></h2></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e817"></a></h2></div></div></div><p></p></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="configure"></a>Chapter&nbsp;4.&nbsp;Configuration</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#config_files">Configuration files</a></span></dt><dd><dl><dt><span class="section"><a href="#config_files_bash">Bash</a></span></dt><dt><span class="section"><a href="#config_files_xml">XML</a></span></dt></dl></dd><dt><span class="section"><a href="#conf_xml_templates_howto">Templates</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e2868">Syntax</a></span></dt><dt><span class="section"><a href="#d0e2872">Template XML elements</a></span></dt><dt><span class="section"><a href="#d0e2946">Template usage guidelines</a></span></dt></dl></dd><dt><span class="section"><a href="#conf_xml_ruleblocks_howto">Ruleblocks</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e2956">Syntax</a></span></dt><dt><span class="section"><a href="#d0e2960">Ruleblock XML elements</a></span></dt><dt><span class="section"><a href="#d0e2964">Ruleblocks usage guidelines</a></span></dt></dl></dd><dt><span class="section"><a href="#conf_xml_rule_files_howto">Rule files</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e2974">Syntax</a></span></dt><dt><span class="section"><a href="#d0e2978">Rule file XML elements</a></span></dt><dt><span class="section"><a href="#pub_funcs">Public functions</a></span></dt><dt><span class="section"><a href="#inline_funcs">inline functions</a></span></dt><dt><span class="section"><a href="#d0e3296">Rulefile usage guidelines</a></span></dt></dl></dd></dl></div><p>This chapter provides information about how to configure IP-Array.</p><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="config_files"></a>Configuration files</h2></div></div></div><p>IP-Array comes with two different kinds of configuration files. Some are written in
        shell, namely bash, syntax, while others are written in a simple XML dialect. The templates,
        ruleblocks and rule files are in XML language. All others are written in bash.</p><p>In upcoming versions of IP-Array, all (or all but the defaults file) configuration files
        will maybe converted to use XML. But this has not been worked out yet.</p><p>
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>All the configuration files are expected to be in the <code class="varname">CONFIG_DIR</code>
            directory, or one of it's sub directories, of the current runmode. If IP-Array is run
            with the 'test' startup parameter the location will be:
              <code class="filename">$BASE_DIR/test/conf.d</code>. In any other startup mode it will be:
              <code class="filename">$BASE_DIR/stable/conf.d</code>.</p></div><p>
      </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="config_files_bash"></a>Bash</h3></div><div><h4 class="subtitle">Description of the bash (shell) configuration files</h4></div></div></div><p></p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="conf_init_script"></a>init script</h4></div></div></div><p>There is a <span class="italic">configuration area</span> in the IP-Array
            init script. The following variables can be configured there:</p><p>
            </p><div class="variablelist"><dl><dt><span class="term"><code class="varname">DEFAULTS_FILE</code></span></dt><dd><p>Mandatory: yes</p><p>Allowed values: A valid path to the defaults file (i.e:
                      <code class="filename">/etc/default/ip-array</code>).</p><p>Purpose: The defaults file holds startup and globally used variables.</p></dd><dt><span class="term"><code class="varname">SYNTAX_CHECK</code></span></dt><dd><p>Mandatory: yes</p><p>Allowed values: `0' or `1'.</p><p>Purpose: Perform a bash grammar check before sourcing or executing
                    files.</p><p>The bash grammar check is done using `<code class="code">bash -n file</code>'. Thus the
                    syntax check is very basic and may not catch all errors (as described in
                      `<code class="code">man bash</code>').</p></dd></dl></div><p>
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="conf_file_defaults"></a>Defaults (defaults.conf)</h4></div></div></div><p>The defaults file contains startup and globally used variables.</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>The location of the defaults file is specified in the IP-Array <a class="link" href="#conf_init_script" title="init script">init script</a>.</p><p>The `<span class="command"><strong>DEFAULTS_FILE</strong></span>' variable must be set and correctly pointing
              to the defaults file i.e.: <code class="code">DEFAULTS_FILE=/etc/default/ip-array</code>.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="d0e917"></a>IP-Array message (logging) output settings</h5></div></div></div><div class="variablelist"><dl><dt><span class="term">
                  <code class="varname">ENABLE_COLORS</code>
                </span></dt><dd><p>Mandatory: no. Defaults to `0' if unset.</p><p>Allowed values: `0' or `1'.</p><p>Purpose: Enable or disable IP-Array coloured output.</p></dd><dt><span class="term">
                  <code class="varname">ENABLE_SYSLOG</code>
                </span></dt><dd><p>Mandatory: no. Defaults to `0' if unset.</p><p>Allowed values: `0' or `1'.</p><p>Purpose: Enable or disable logging of IP-Array's output to syslog using the
                      <span class="command"><strong>logger</strong></span> utility.</p></dd><dt><span class="term">
                  <code class="varname">LOG_FACILITY</code>
                </span></dt><dd><p>Mandatory: no. Defaults to `local0' if unset.</p><p>Allowed values: <span class="simplelist">auth, authpriv (for security information of a
                        sensitive
                        nature), cron, daemon, ftp, kern, lpr, mail, news, security
                        (deprecated synonym for
                        auth), syslog, user, uucp, local0
                        to local7 inclusive</span>.</p><p>Purpose: Configure IP-Array's syslog logging facility.</p></dd><dt><span class="term">
                  <code class="varname">VERBOSE</code>
                </span></dt><dd><p>Mandatory: no. Defaults to `6' if unset.</p><p>Allowed values: `0' to `8'.</p><p>Purpose: Control level of IP-Array's output verbosity.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Tip</h3><p>With a non zero environment variable `<code class="varname">DEBUG_INFO</code>',
                      additional processing (debugging) information is printed.</p></div><div class="orderedlist"><ol start="0" type="1"><li><p> No messages are shown. Exit status indicates success or failure.</p></li><li><p>Shows start and end message and errors.</p></li><li><p>Main title and warning messages are also shown.</p></li><li><p>Sub title messages are shown in addition.</p></li><li><p>Info title, config and rule file loading messages, are shown
                        additionally.</p></li><li><p>Also show notice messages.</p></li><li><p>Verbose output.</p></li><li><p>Debug mode (set -x).</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Tip</h3><p>With a non zero environment variable `<code class="varname">DEBUG_INFO</code>',
                          a debugging `<code class="varname">PS4</code>' is set.</p></div></li><li><p>More verbose debug mode (set -vx).</p></li></ol></div></dd><dt><span class="term">
                  <code class="varname">SYSLOG_VERBOSE</code>
                </span></dt><dd><p>Mandatory: no. Defaults to `1' if unset.</p><p>Allowed values: `0' to `5'.</p><p>Purpose: Control verbosity level of IP-Array's syslog logging.</p><div class="orderedlist"><ol start="0" type="1"><li><p> Errror messages are shown.</p></li><li><p>Main title and warning messages are shown.</p></li><li><p>Subtitle messages are shown in addition.</p></li><li><p>Info title, config and rule file loading messages, are shown
                          additionally.</p></li><li><p>Also show notice messages.</p></li><li><p>Verbose output.</p></li></ol></div></dd><dt><span class="term">
                  <code class="varname">COLOR_MSG_MAIN_TITLE</code>
                </span></dt><dd><p>Mandatory: no. Defaults to `magenta' if unset.</p><p>Allowed values: <span class="simplelist">black, blue, cyan, green, magenta, red, white, yellow</span>.</p><p>Purpose: Set color for title messages.</p></dd><dt><span class="term">
                  <code class="varname">COLOR_MSG_SUBTITLE</code>
                </span></dt><dd><p>Mandatory: no. Defaults to `blue' if unset.</p><p>Allowed values: <span class="simplelist">black, blue, cyan, green, magenta, red, white, yellow</span>.</p><p>Purpose: Set color for sub title messages.</p></dd><dt><span class="term">
                  <code class="varname">COLOR_MSG_INFO_TITLE</code>
                </span></dt><dd><p>Mandatory: no. Defaults to `cyan' if unset.</p><p>Allowed values: <span class="simplelist">black, blue, cyan, green, magenta, red, white, yellow</span>.</p><p>Purpose: Set color for info title messages.</p></dd><dt><span class="term">
                  <code class="varname">COLOR_MSG_ERROR</code>
                </span></dt><dd><p>Mandatory: no. Defaults to `red' if unset.</p><p>Allowed values: <span class="simplelist">black, blue, cyan, green, magenta, red, white, yellow</span>.</p><p>Purpose: Set color for error messages.</p></dd><dt><span class="term">
                  <code class="varname">COLOR_MSG_WARNING</code>
                </span></dt><dd><p>Mandatory: no. Defaults to `yellow' if unset.</p><p>Allowed values: <span class="simplelist">black, blue, cyan, green, magenta, red, white, yellow</span>.</p><p>Purpose: Set color for warning messages.</p></dd><dt><span class="term">
                  <code class="varname">COLOR_MSG_NOTICE</code>
                </span></dt><dd><p>Mandatory: no. Defaults to `white' if unset.</p><p>Allowed values: <span class="simplelist">black, blue, cyan, green, magenta, red, white, yellow</span>.</p><p>Purpose: Set color for notice messages.</p></dd><dt><span class="term">
                  <code class="varname">COLOR_MSG_CONFIG_LOAD</code>
                </span></dt><dd><p>Mandatory: no. Defaults to `green' if unset.</p><p>Allowed values: <span class="simplelist">black, blue, cyan, green, magenta, red, white, yellow</span>.</p><p>Purpose: Set color for configuration file loading messages.</p></dd><dt><span class="term">
                  <code class="varname">COLOR_MSG_RULE_LOAD</code>
                </span></dt><dd><p>Mandatory: no. Defaults to `yellow' if unset.</p><p>Allowed values: <span class="simplelist">black, blue, cyan, green, magenta, red, white, yellow</span>.</p><p>Purpose: Set color for rule file loading messages.</p></dd></dl></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="d0e1329"></a>Programs mandatory to run IP-Array</h5></div></div></div><div class="variablelist"><dl><dt><span class="term">
                  <code class="varname">AUTO_GET_PROGS</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: `0' or `1'.</p><p>Purpose: Configure if IP-Array should try to automatically find the
                    mandatory programs. If disabled (set to `0'), the program names varaibles
                    (below) <span class="bold"><strong>must</strong></span> be configured manually.</p></dd><dt><span class="term">
                  <code class="varname">AWK</code>
                </span></dt><dd><p>Allowed values: A valid path to the <span class="command"><strong>awk</strong></span> executable file
                    (i.e: <code class="filename">/usr/bin/awk</code>), or the just the name of the program
                    (if it's found in <code class="varname">PATH</code>) and you do not want to use absolute
                    paths.</p></dd><dt><span class="term">
                  <code class="varname">CAT</code>
                </span></dt><dd><p>Allowed values: A valid path to the <span class="command"><strong>cat</strong></span> executable file
                    (i.e: <code class="filename">/bin/cat</code>), or the just the name of the program (if
                    it's found in <code class="varname">PATH</code>) and you do not want to use absolute
                    paths.</p></dd><dt><span class="term">
                  <code class="varname">DATE</code>
                </span></dt><dd><p>Allowed values: A valid path to the <span class="command"><strong>date</strong></span> executable file
                    (i.e: <code class="filename">/bin/date</code>), or the just the name of the program (if
                    it's found in <code class="varname">PATH</code>) and you do not want to use absolute
                    paths.</p></dd><dt><span class="term">
                  <code class="varname">FIND</code>
                </span></dt><dd><p>Allowed values: A valid path to the <span class="command"><strong>find</strong></span> executable file
                    (i.e: <code class="filename">/usr/bin/find</code>), or the just the name of the program
                    (if it's found in <code class="varname">PATH</code>) and you do not want to use absolute
                    paths.</p></dd><dt><span class="term">
                  <code class="varname">GREP</code>
                </span></dt><dd><p>Allowed values: A valid path to the <span class="command"><strong>grep</strong></span> executable file
                    (i.e: <code class="filename">/bin/grep</code>), or the just the name of the program (if
                    it's found in <code class="varname">PATH</code>) and you do not want to use absolute
                    paths.</p></dd><dt><span class="term">
                  <code class="varname">IP</code>
                </span></dt><dd><p>Allowed values: A valid path to the <span class="command"><strong>ip</strong></span> executable file
                    (i.e: <code class="filename">/sbin/ip</code>), or the just the name of the program (if
                    it's found in <code class="varname">PATH</code>) and you do not want to use absolute
                    paths.</p></dd><dt><span class="term">
                  <code class="varname">IPT</code>
                </span></dt><dd><p>Allowed values: A valid path to the <span class="command"><strong>iptables</strong></span> executable
                    file (i.e: <code class="filename">/sbin/iptables</code>), or the just the name of the
                    program (if it's found in <code class="varname">PATH</code>) and you do not want to use
                    absolute paths.</p></dd><dt><span class="term">
                  <code class="varname">LOGGER</code>
                </span></dt><dd><p>Allowed values: A valid path to the <span class="command"><strong>logger</strong></span> executable
                    file (i.e: <code class="filename">/usr/bin/logger</code>), or the just the name of the
                    program (if it's found in <code class="varname">PATH</code>) and you do not want to use
                    absolute paths.</p></dd><dt><span class="term">
                  <code class="varname">LSMOD</code>
                </span></dt><dd><p>Allowed values: A valid path to the <span class="command"><strong>lsmod</strong></span> executable file
                    (i.e: <code class="filename">/sbin/lsmod</code>), or the just the name of the program (if
                    it's found in <code class="varname">PATH</code>) and you do not want to use absolute
                    paths.</p></dd><dt><span class="term">
                  <code class="varname">MKDIR</code>
                </span></dt><dd><p>Allowed values: A valid path to the <span class="command"><strong>mkdir</strong></span> executable file
                    (i.e: <code class="filename">/bin/mkdir</code>), or the just the name of the program (if
                    it's found in <code class="varname">PATH</code>) and you do not want to use absolute
                    paths.</p></dd><dt><span class="term">
                  <code class="varname">MODPROBE</code>
                </span></dt><dd><p>Allowed values: A valid path to the <span class="command"><strong>modprobe</strong></span> executable
                    file (i.e: <code class="filename">/sbin/modprobe</code>), or the just the name of the
                    program (if it's found in <code class="varname">PATH</code>) and you do not want to use
                    absolute paths.</p></dd><dt><span class="term">
                  <code class="varname">RM</code>
                </span></dt><dd><p>Allowed values: A valid path to the <span class="command"><strong>rm</strong></span> executable file
                    (i.e: <code class="filename">/bin/rm</code>), or the just the name of the program (if
                    it's found in <code class="varname">PATH</code>) and you do not want to use absolute
                    paths.</p></dd><dt><span class="term">
                  <code class="varname">SED</code>
                </span></dt><dd><p>Allowed values: A valid path to the <span class="command"><strong>sed</strong></span> executable file
                    (i.e: <code class="filename">/bin/sed</code>), or the just the name of the program (if
                    it's found in <code class="varname">PATH</code>) and you do not want to use absolute
                    paths.</p></dd><dt><span class="term">
                  <code class="varname">SEQ</code>
                </span></dt><dd><p>Allowed values: A valid path to the <span class="command"><strong>seq</strong></span> executable file
                    (i.e: <code class="filename">/usr/bin/seq</code>), or the just the name of the program
                    (if it's found in <code class="varname">PATH</code>) and you do not want to use absolute
                    paths.</p></dd><dt><span class="term">
                  <code class="varname">TC</code>
                </span></dt><dd><p>Allowed values: A valid path to the <span class="command"><strong>tc</strong></span> executable file
                    (i.e: <code class="filename">/sbin/tc</code>), or the just the name of the program (if
                    it's found in <code class="varname">PATH</code>) and you do not want to use absolute
                    paths.</p></dd><dt><span class="term">
                  <code class="varname">UNAME</code>
                </span></dt><dd><p>Allowed values: A valid path to the <span class="command"><strong>uname</strong></span> executable file
                    (i.e: <code class="filename">/bin/uname</code>), or the just the name of the program (if
                    it's found in <code class="varname">PATH</code>) and you do not want to use absolute
                    paths.</p></dd><dt><span class="term">
                  <code class="varname">IPT_SAVE</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: A valid path to the <span class="command"><strong>iptables-save</strong></span>
                    executable file (i.e: <code class="filename">/sbin/iptables-save</code>), or the just the
                    name of the program (if it's found in <code class="varname">PATH</code>) and you do not
                    want to use absolute paths.</p><p>This variable is only used by the IP-Array init script. It is not globally
                    available.</p></dd><dt><span class="term">
                  <code class="varname">IPT_RESTORE</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: A valid path to the <span class="command"><strong>iptables-restore</strong></span>
                    executable file (i.e: <code class="filename">/sbin/iptables-restore</code>), or the just
                    the name of the program (if it's found in <code class="varname">PATH</code>) and you do
                    not want to use absolute paths.</p><p>This variable is only used by the IP-Array init script. It is not globally
                    available.</p></dd><dt><span class="term">
                  <code class="varname">AT</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: A valid path to the <span class="command"><strong>at</strong></span> executable file
                    (i.e: <code class="filename">/usr/bin/at</code>), or the just the name of the program (if
                    it's found in <code class="varname">PATH</code>) and you do not want to use absolute
                    paths.</p><p>This variable is only used by the IP-Array init script. It is not globally
                    available.</p></dd></dl></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="d0e1703"></a>Files and directories</h5></div></div></div><div class="variablelist"><dl><dt><span class="term">
                  <code class="varname">BASE_DIR</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: A valid path (i.e.:
                    <code class="filename">/etc/ip-array</code>).</p><p>IP-Array base directory.</p></dd><dt><span class="term">
                  <code class="varname">CONFIG</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: A valid filename (i.e.:
                    <code class="filename">ip-array.conf</code>).</p><p>Name of the main configuration file.</p></dd><dt><span class="term">
                  <code class="varname">BIN_DIR</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: A valid path (i.e.:
                    <code class="filename">/usr/bin/ip-array</code>).</p><p>Directory to put the IP-Array executable (main script) into.</p></dd><dt><span class="term">
                  <code class="varname">LIB_DIR</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: A valid path (i.e.:
                    <code class="filename">/usr/lib/ip-array</code>).</p><p>Library directory used for the IP-Array function files.</p></dd><dt><span class="term">
                  <code class="varname">SAVE_FILE</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: A valid filename (i.e.:
                      <code class="filename">iptables_ruleset.save</code>).</p><p>File to put the iptables-save output into, when executing IP-Array with the
                    'save' startup parameter.</p></dd><dt><span class="term">
                  <code class="varname">RULESETFILE</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: A valid filename (i.e.:
                      <code class="filename">ip-array_commands.bash</code>).</p><p>File where the generated commands will be saved, if executing IP-Array with
                    one of the 'save[ -iptables | -modprobe | -proc | -tc | -shaping ]-commands'
                    parameters. The target directory will be <span class="command"><strong>SAVE_DIR</strong></span>.</p></dd><dt><span class="term">
                  <code class="varname">DIFF_FILE</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: A valid filename (i.e.:
                      <code class="filename">iptables_ruleset_saved_for_diff</code>).</p><p>File to save the iptables rule listing (iptables -nL) into, after applying
                    the rules. The target directory will be <span class="command"><strong>SAVE_DIR</strong></span>.</p><p>This file will be used to check for a difference to the currently active
                    ruleset, when using the 'diff-last-activated' startup parameter.</p></dd><dt><span class="term">
                  <code class="varname">SERVICES</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: A valid path to the services file (most likely:
                      <code class="filename">/etc/services</code>).</p><p>Purpose: Configure the location of the services file (containing service
                    definitions).</p></dd><dt><span class="term">
                  <code class="varname">PROTOCOLS</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: A valid path to the services file (most likely:
                      <code class="filename">/etc/protocols</code>).</p><p>Purpose: Configure the location of the protocols file (containing protocol
                    definitions).</p></dd></dl></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="d0e1859"></a>Quick start settings</h5></div></div></div><p>Files to load, if <code class="varname">RESTORE_ON_START</code> is `1'.</p><div class="variablelist"><dl><dt><span class="term">
                  <code class="varname">KNOWN_GOOD_RULES</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: A valid filename (i.e.:
                      <code class="filename">KNOWN_GOOD_IPT_RULES.save</code>).</p><p>File to save the currently active 'known good' ruleset with iptables-save.
                    This file will be used to restore the iptables ruleset on 'start', if
                      <code class="varname">RESTORE_ON_START</code> is enabled.</p></dd><dt><span class="term">
                  <code class="varname">KNOWN_GOOD_MODPROBES</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: A valid filename (i.e.:
                      <code class="filename">KNOWN_GOOD_MODPROBES.bash</code>).</p><p>File to save the generated modprobe commands into. This file will be used to
                    restore the kernel module state on 'start', if
                      <code class="varname">RESTORE_ON_START</code> is enabled.</p></dd><dt><span class="term">
                  <code class="varname">KNOWN_GOOD_PROC_SET</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: A valid filename (i.e.:
                      <code class="filename">KNOWN_GOOD_SYSCTL.bash</code>).</p><p>File to save the generated /proc commands into. This file will be used to
                    restore the /proc configuration on 'start', if
                      <code class="varname">RESTORE_ON_START</code> is enabled.</p></dd><dt><span class="term">
                  <code class="varname">KNOWN_GOOD_TRAFFIC_CONTROL</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: A valid filename (i.e.:
                      <code class="filename">KNOWN_GOOD_TC.bash</code>).</p><p> File to save the generated tc commands into. This file will be used to
                    restore the traffic control ruleset on 'start', if
                      <code class="varname">RESTORE_ON_START</code> is enabled.</p></dd></dl></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="d0e1944"></a>Basic configuration variables</h5></div></div></div><div class="variablelist"><dl><dt><span class="term">
                  <code class="varname">RELOAD_TIME</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: Any value, that is valid as input to the
                      <span class="command"><strong>at</strong></span> command. I.e.: <code class="code">5 minutes</code>.</p><p>Time period until the previously saved ruleset will be restored, when using
                    the 'test' startup parameter.</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>If <span class="command"><strong>iptables-save</strong></span> or
                          <span class="command"><strong>iptables-restore</strong></span> fails for some reason, the 'test'
                        parameter will not work, thus this setting will not produce the desired
                        effect.</p></div></dd><dt><span class="term">
                  <code class="varname">RESTORE_ON_START</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: `0' or `1'.</p><p>Restore saved ruleset(s) and or commands on start (quick start). If found,
                    any of the 'known-good' scripts or rulesets, will be loaded.</p></dd><dt><span class="term">
                  <code class="varname">IPTSAVE_FAILS</code>
                </span></dt><dd><p>Mandatory: yes</p><p>Allowed values: `0' or `1'.</p><p>Enable this if saving or restoring with <span class="command"><strong>iptables-save</strong></span> or
                      <span class="command"><strong>iptables-restore</strong></span> fails for some reason.</p><p>If yes, and <code class="varname">RESTORE_ON_START</code> is enabled, the iptables
                    ruleset will be saved like running IP-Array with the 'save-iptables-commands'
                    parameter. The saved script will then be executed on 'start'.</p><p>
                    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>Any startup mode, that utilizes <span class="command"><strong>iptables-save</strong></span> or
                          <span class="command"><strong>iptables-restore</strong></span> will not work in that case.</p></div><p>
                  </p></dd></dl></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="conf_file_main_conf"></a>Main configuration file (ip-array.conf)</h4></div></div></div><p>This file is the main IP-Array configuration file.</p><p>
            </p><div class="variablelist"><dl><dt><span class="term">CONFIG_FILES</span></dt><dd><p></p></dd><dt><span class="term">BASE_TEMPLATES</span></dt><dd><p></p></dd><dt><span class="term">IPT_FILTER_TEMPLATES</span></dt><dd><p></p></dd><dt><span class="term">IPT_MANGLE_TEMPLATES</span></dt><dd><p></p></dd><dt><span class="term">IPT_NAT_TEMPLATES</span></dt><dd><p></p></dd><dt><span class="term">IPT_RAW_TEMPLATES</span></dt><dd><p></p></dd><dt><span class="term">FILTER_RULEBLOCKS</span></dt><dd><p></p></dd><dt><span class="term">MANGLE_RULEBLOCKS</span></dt><dd><p></p></dd><dt><span class="term">NAT_RULEBLOCKS</span></dt><dd><p></p></dd><dt><span class="term">RAW_RULEBLOCKS</span></dt><dd><p></p></dd><dt><span class="term">TC_RULEBLOCKS</span></dt><dd><p></p></dd><dt><span class="term">TC_MANGLE_RULEBLOCKS</span></dt><dd><p></p></dd><dt><span class="term">MODULE_DIR</span></dt><dd><p></p></dd><dt><span class="term">MODULES_TO_LOAD</span></dt><dd><p></p></dd><dt><span class="term">MODS_TO_RM</span></dt><dd><p></p></dd><dt><span class="term">ENABLE_FILTER</span></dt><dd><p></p></dd><dt><span class="term">FILTER_RULES</span></dt><dd><p></p></dd><dt><span class="term">ENABLE_MANGLE</span></dt><dd><p></p></dd><dt><span class="term">MANGLE_RULES</span></dt><dd><p></p></dd><dt><span class="term">ENABLE_NAT</span></dt><dd><p></p></dd><dt><span class="term">NAT_RULES</span></dt><dd><p></p></dd><dt><span class="term">ENABLE_RAW</span></dt><dd><p></p></dd><dt><span class="term">RAW_RULES</span></dt><dd><p></p></dd><dt><span class="term">ENABLE_IPSEC</span></dt><dd><p></p></dd><dt><span class="term">ALLOW_ALL_BRANCH</span></dt><dd><p></p></dd><dt><span class="term">IPSEC_RULES</span></dt><dd><p></p></dd><dt><span class="term">ENABLE_TC_SHAPING</span></dt><dd><p></p></dd><dt><span class="term">TC_MARK_RULES</span></dt><dd><p></p></dd><dt><span class="term">OUTPUT_BULK</span></dt><dd><p></p></dd><dt><span class="term">FORWARD_BULK</span></dt><dd><p></p></dd><dt><span class="term">PRIORITIZE_SYN</span></dt><dd><p></p></dd><dt><span class="term">POLICY_MAP</span></dt><dd><p></p></dd><dt><span class="term">CHAIN_MAP</span></dt><dd><p></p></dd><dt><span class="term">LOG_INVALID</span></dt><dd><p></p></dd><dt><span class="term">BLOCK_INVALID</span></dt><dd><p></p></dd><dt><span class="term">LOG_ILLEGAL</span></dt><dd><p></p></dd><dt><span class="term">BLOCK_ILLEGAL</span></dt><dd><p></p></dd><dt><span class="term">BLOCK_FRAGMENTS</span></dt><dd><p></p></dd><dt><span class="term">LOG_FRAGMENTS</span></dt><dd><p></p></dd><dt><span class="term">LAN_FTP_INTERFACES</span></dt><dd><p></p></dd><dt><span class="term">ACTIVE_FTP_INTERFACES</span></dt><dd><p></p></dd><dt><span class="term">PASSIVE_FTP_INTERFACES</span></dt><dd><p></p></dd><dt><span class="term">ALLOW_WMP</span></dt><dd><p></p></dd><dt><span class="term">ALLOW_RMP</span></dt><dd><p></p></dd><dt><span class="term">AUTO_PROV_DNS</span></dt><dd><p></p></dd><dt><span class="term">AUTO_ROOT_DNS</span></dt><dd><p></p></dd><dt><span class="term">AUTO_ISP_SMTP</span></dt><dd><p></p></dd><dt><span class="term">RESTRICT_OUTPUT</span></dt><dd><p></p></dd><dt><span class="term">REST_OUT_DNS_ALLOW</span></dt><dd><p></p></dd><dt><span class="term">REST_OUT_NTP_ALLOW</span></dt><dd><p></p></dd><dt><span class="term">REST_OUT_LAN_ALLOW</span></dt><dd><p></p></dd><dt><span class="term">REST_ALLOW_RELATED</span></dt><dd><p></p></dd><dt><span class="term">REJECT_AUTH</span></dt><dd><p></p></dd><dt><span class="term">DROP_NETBIOS</span></dt><dd><p></p></dd><dt><span class="term">DROP_DHCP</span></dt><dd><p></p></dd><dt><span class="term">DROP_UPNP</span></dt><dd><p></p></dd><dt><span class="term">DROP_Stealth_XMAS</span></dt><dd><p></p></dd><dt><span class="term">DROP_Stealth_XMAS_PSH</span></dt><dd><p></p></dd><dt><span class="term">DROP_Stealth_XMAS_ALL</span></dt><dd><p></p></dd><dt><span class="term">DROP_Stealth_FIN</span></dt><dd><p></p></dd><dt><span class="term">DROP_Stealth_SYN_RST</span></dt><dd><p></p></dd><dt><span class="term">DROP_Stealth_SYN_FIN</span></dt><dd><p></p></dd><dt><span class="term">DROP_Stealth_Null</span></dt><dd><p></p></dd><dt><span class="term">EXIT_ON_ERROR</span></dt><dd><p></p></dd><dt><span class="term">ADMIN_CONNECTION</span></dt><dd><p></p></dd><dt><span class="term">RULE_PLACEHOLDER</span></dt><dd><p></p></dd><dt><span class="term">SCRIPT_MAP</span></dt><dd><p></p></dd><dt><span class="term">ALLOW_LOOPBACK</span></dt><dd><p></p></dd><dt><span class="term">TCPMSS_TO_MTU</span></dt><dd><p></p></dd><dt><span class="term">FINAL_RULE</span></dt><dd><p></p></dd><dt><span class="term">LOG_PREFIX</span></dt><dd><p></p></dd><dt><span class="term">GLOBAL_LOGLIMIT</span></dt><dd><p></p></dd><dt><span class="term">GLOBAL_BURSTLIMIT</span></dt><dd><p></p></dd><dt><span class="term">GLOBAL_LOGLEVL</span></dt><dd><p></p></dd><dt><span class="term">LOG_Stealth_XMAS</span></dt><dd><p></p></dd><dt><span class="term">LOG_Stealth_XMAS_PSH</span></dt><dd><p></p></dd><dt><span class="term">LOG_Stealth_XMAS_ALL</span></dt><dd><p></p></dd><dt><span class="term">LOG_Stealth_FIN</span></dt><dd><p></p></dd><dt><span class="term">LOG_Stealth_SYN_RST</span></dt><dd><p></p></dd><dt><span class="term">LOG_Stealth_SYN_FIN</span></dt><dd><p></p></dd><dt><span class="term">LOG_Stealth_Null</span></dt><dd><p></p></dd><dt><span class="term"></span></dt><dd><p></p></dd><dt><span class="term"></span></dt><dd><p></p></dd><dt><span class="term"></span></dt><dd><p></p></dd><dt><span class="term"></span></dt><dd><p></p></dd><dt><span class="term"></span></dt><dd><p></p></dd><dt><span class="term"></span></dt><dd><p></p></dd></dl></div><p>
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="conf_file_local_conf"></a>Local settings - configuration file (local.conf)</h4></div></div></div><p>This file is supposed to hold variable definitions, which only apply to the current
            working system. They may not be used on any other host.</p><p>
            </p><div class="variablelist"><dl><dt><span class="term"><code class="varname">LOCAL_BRANCH</code></span></dt><dd><p>Allowed values: Characters of calss [:word:] (alphanumeric and the `_'
                    (underline) character). </p><p>Purpose: Set name of the local VPN branch.</p></dd><dt><span class="term"><code class="varname">LOOPBACK_IF</code></span></dt><dd><p>Allowed values: A valid interface name. </p><p>Purpose: Name of the loopback interface.</p></dd><dt><span class="term"><code class="varname">NET_INTERFACES</code></span></dt><dd><p>Types: ext | local | ipsec</p><p>
                    </p><div class="table"><a name="d0e2498"></a><p class="title"><b>Table&nbsp;4.1.&nbsp;Configure networking interfaces</b></p><div class="table-contents"><table summary="Configure networking interfaces" border="1"><colgroup><col align="left"><col align="left"><col align="left"><col align="left"></colgroup><thead><tr><th align="left">Inteface name</th><th align="left">Interface alias</th><th align="left">Type[:ipsec]</th><th align="left">Network name</th></tr></thead><tbody><tr><td align="left">eth0</td><td align="left">eth0</td><td align="left">ext:ipsec</td><td align="left">INET_CON_X</td></tr><tr><td align="left">eth1</td><td align="left">eth1</td><td align="left">ext</td><td align="left">INET_CON_Y</td></tr><tr><td align="left">eth2</td><td align="left">eth2</td><td align="left">local</td><td align="left">PRODUCTION</td></tr><tr><td align="left">eth2</td><td align="left">eth2:0</td><td align="left">local</td><td align="left">DEVELOPMENT</td></tr><tr><td align="left">eth3</td><td align="left">eth3</td><td align="left">local</td><td align="left">DMZ</td></tr><tr><td align="left">ipsec0</td><td align="left">ipsec0</td><td align="left">ipsec</td><td align="left">VPN_REMOTE_OFFICE</td></tr></tbody></table></div></div><p><br class="table-break">
                  </p></dd><dt><span class="term"><code class="varname">LAN_NS</code></span></dt><dd><p>Purpose: Define name servers (DNS) that are part of a local area
                    network.</p><p>
                    </p><div class="table"><a name="d0e2581"></a><p class="title"><b>Table&nbsp;4.2.&nbsp;Local (LAN) name servers</b></p><div class="table-contents"><table summary="Local (LAN) name servers" border="1"><colgroup><col align="left"><col align="left"><col align="left"></colgroup><thead><tr><th align="left">Network name</th><th align="left">Name server IP address</th><th align="left">[Name server MAC address]</th></tr></thead><tbody><tr><td align="left">DMZ</td><td align="left">10.11.11.11</td><td align="left">AA:BB:CC:DD:EE:FF</td></tr><tr><td align="left">DMZ</td><td align="left">10.11.11.12</td><td align="left">&nbsp;</td></tr></tbody></table></div></div><p><br class="table-break">
                  </p></dd><dt><span class="term"><code class="varname">ISP_NS</code></span></dt><dd><p>Purpose: Define the Internet service provider name servers (DNS), for each
                    local area network.</p><p>
                    </p><div class="table"><a name="d0e2620"></a><p class="title"><b>Table&nbsp;4.3.&nbsp;ISP name servers</b></p><div class="table-contents"><table summary="ISP name servers" border="1"><colgroup><col align="left"><col align="left"><col align="left"></colgroup><thead><tr><th align="left">Network name</th><th align="left">ISP name server IP address[,...]</th><th align="left">[External network interface]</th></tr></thead><tbody><tr><td align="left">PRODUCTION</td><td align="left">123.12.12.22,123.12.12.23</td><td align="left">eth1</td></tr><tr><td align="left">DEVELOPMENT</td><td align="left">124.13.13.23,124.13.13.24</td><td align="left">&nbsp;</td></tr></tbody></table></div></div><p><br class="table-break">
                  </p></dd><dt><span class="term"><code class="varname">LOCAL_NS</code></span></dt><dd><p>Purpose: Define name servers (DNS) of the local system (most likely those
                    configured in <code class="filename">/etc/resolv.conf</code>.</p><p>
                    </p><div class="table"><a name="d0e2662"></a><p class="title"><b>Table&nbsp;4.4.&nbsp;Local name servers (resolv.conf)</b></p><div class="table-contents"><table summary="Local name servers (resolv.conf)" border="1"><colgroup><col align="left"><col align="left"></colgroup><thead><tr><th align="left">Name server IP address</th><th align="left">[External network name]</th></tr></thead><tbody><tr><td align="left">123.12.12.22,123.12.12.23</td><td align="left">INET_CON_ISP_X</td></tr><tr><td align="left">124.13.13.23,124.13.13.24</td><td align="left">&nbsp;</td></tr></tbody></table></div></div><p><br class="table-break">
                  </p></dd><dt><span class="term"><code class="varname">ISP_SMTP</code></span></dt><dd><p>Purpose: Define the Internet service provider mail servers (SMTP), for each
                    local area network.</p><p>
                    </p><div class="table"><a name="d0e2694"></a><p class="title"><b>Table&nbsp;4.5.&nbsp;ISP SMTP servers</b></p><div class="table-contents"><table summary="ISP SMTP servers" border="1"><colgroup><col align="left"><col align="left"><col align="left"></colgroup><thead><tr><th align="left">Network name</th><th align="left">ISP mail server IP address[,...]</th><th align="left">[External network name]</th></tr></thead><tbody><tr><td align="left">PRODUCTION</td><td align="left">123.12.12.90,123.12.12.91</td><td align="left">INET_CON_ISP_X</td></tr><tr><td align="left">DEVELOPMENT</td><td align="left">125.25.25.5,125.25.25.6</td><td align="left">INET_CON_ISP_Y</td></tr><tr><td align="left">DMZ</td><td align="left">126.26.26.6,128.28.28.8</td><td align="left">&nbsp;</td></tr></tbody></table></div></div><p><br class="table-break">
                  </p></dd><dt><span class="term"><code class="varname">TIME_SERVERS</code></span></dt><dd><p>Purpose: Define time servers (NTP) of the local system.</p><p>
                    </p><div class="table"><a name="d0e2740"></a><p class="title"><b>Table&nbsp;4.6.&nbsp;Local NTP servers</b></p><div class="table-contents"><table summary="Local NTP servers" border="1"><colgroup><col align="left"><col align="left"></colgroup><thead><tr><th align="left">NTP server IP address[,...]</th><th align="left">[External network name]</th></tr></thead><tbody><tr><td align="left">11.12.13.14,12.13.14.15</td><td align="left">INET_CON_ISP_X</td></tr><tr><td align="left">99.99.99.9,99.99.99.10</td><td align="left">&nbsp;</td></tr></tbody></table></div></div><p><br class="table-break">
                  </p></dd></dl></div><p>
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="conf_file_global_conf"></a>Global settings - configuration file (global.conf)</h4></div></div></div><p>This file is supposed to hold global variable definitions (i.e. ports, network
            classes), which do not apply to the current working system only, but are of generic use,
            to be utilized on any or more than one host.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="conf_file_ipsec_conf"></a>IPSEC configuration (vpn.conf)</h4></div></div></div><p>In this file the IPSEC (VPN) configuration is defined by the
              <code class="varname">VPN_MAP</code> variable, which holds the vpn branch data.</p><p>If <code class="varname">ENABLE_IPSEC</code> is disabled, loading this file becomes
            obsolet.</p><p>The VPN_MAP variable is structured as follows (example data provided):</p><p>
            </p><div class="table"><a name="d0e2786"></a><p class="title"><b>Table&nbsp;4.7.&nbsp;VPN_MAP structure</b></p><div class="table-contents"><table summary="VPN_MAP structure" border="1"><colgroup><col align="left"><col align="left"><col align="left"><col align="left"></colgroup><thead><tr><th align="left">Branch name</th><th align="left">External IP address</th><th align="left">LAN address/mask</th><th align="left">LAN interface IP address</th></tr></thead><tbody><tr><td align="left">local_branch</td><td align="left">188.88.88.8</td><td align="left">192.168.1.0/24</td><td align="left">192.168.1.1</td></tr><tr><td align="left">remote_branch_01</td><td align="left">177.77.77.7</td><td align="left">10.1.1.0/24</td><td align="left">10.1.1.1</td></tr><tr><td align="left">remote_branch_02</td><td align="left">166.66.66.6</td><td align="left">172.16.1.0/24</td><td align="left">172.16.1.1</td></tr></tbody></table></div></div><p><br class="table-break">
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="conf_file_alias_conf"></a>Custom variables/namings (alias.conf)</h4></div></div></div><p>This file is supposed to hold custom (user defined) variables.</p><p>Most likely the user will put definitions for interface names, hosts, etc.</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="config_files_xml"></a>XML</h3></div><div><h4 class="subtitle">Description of the XML configuration files</h4></div></div></div><p></p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="conf_file_xml_def"></a>XML guidelines</h4></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="conf_file_xml_templates"></a>XML templates</h4></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="conf_file_xml_ruleblocks"></a>XML ruleblocks</h4></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="conf_file_xml_rule_files"></a>XML rule files</h4></div></div></div><p></p></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="conf_xml_templates_howto"></a>Templates</h2></div><div><h3 class="subtitle">How to configure XML templates</h3></div></div></div><p></p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2868"></a>Syntax</h3></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2872"></a>Template XML elements</h3></div></div></div><p></p><div class="variablelist"><dl><dt><span class="term">ipt_table</span></dt><dd><p></p></dd><dt><span class="term">ipt_targets</span></dt><dd><p></p></dd><dt><span class="term">ipt_chains</span></dt><dd><p></p></dd><dt><span class="term">reverse_mode</span></dt><dd><p></p></dd><dt><span class="term">reverse_condition</span></dt><dd><p></p></dd><dt><span class="term">ruleblock_msg</span></dt><dd><p></p></dd><dt><span class="term">mandatory_vars</span></dt><dd><p></p></dd><dt><span class="term">load_template</span></dt><dd><p></p></dd><dt><span class="term">always_use_0</span></dt><dd><p></p></dd><dt><span class="term">always_use_1</span></dt><dd><p></p></dd><dt><span class="term">option_list_0</span></dt><dd><p></p></dd><dt><span class="term">option_list_1</span></dt><dd><p></p></dd><dt><span class="term">state_match_arg</span></dt><dd><p></p></dd></dl></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="option_lists"></a>Option lists</h4></div></div></div><p></p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2946"></a>Template usage guidelines</h3></div></div></div><p></p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="conf_xml_ruleblocks_howto"></a>Ruleblocks</h2></div><div><h3 class="subtitle">How to configure XML ruleblocks</h3></div></div></div><p></p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2956"></a>Syntax</h3></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2960"></a>Ruleblock XML elements</h3></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2964"></a>Ruleblocks usage guidelines</h3></div></div></div><p></p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="conf_xml_rule_files_howto"></a>Rule files</h2></div><div><h3 class="subtitle">How to configure XML rule files</h3></div></div></div><p></p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2974"></a>Syntax</h3></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2978"></a>Rule file XML elements</h3></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="pub_funcs"></a>Public functions</h3></div></div></div><p></p><div class="variablelist"><dl><dt><span class="term">add_rule</span></dt><dd><p>Description: Add (append) an iptables rule to the command queue (array). Can
                also be used as 'inline' command.</p><p>Usage:</p><div class="cmdsynopsis"><p><code class="command">add_rule</code>  {<em class="replaceable"><code>table</code></em>} {<em class="replaceable"><code>chain</code></em>} {<em class="replaceable"><code>rest-of-rule-string</code></em>}</p></div><p>Example: <code class="code">add_rule filter INPUT -s 10.0.0.1 -j DROP</code></p></dd><dt><span class="term">log</span></dt><dd><p>Description: IP-Array messaging (logging) to stdout/stderr and/or syslog.</p><p>Usage:</p><div class="cmdsynopsis"><p><code class="command">log</code>  {option}  <em class="replaceable"><code>message</code></em>... </p></div><p>available options:</p><table class="simplelist" border="0" summary="Simple list"><tr><td>-e Unformatted message shown if <code class="varname">VERBOSE</code> is greater or
                  equal `6'.</td></tr><tr><td>-l Log to syslog. Regardless of the <code class="varname">SYSLOG_VERBOSE</code>
                  setting.</td></tr><tr><td>-m Log to stdout and syslog. Regardless of the <code class="varname">VERBOSE</code>
                  and <code class="varname">SYSLOG_VERBOSE</code> setting.</td></tr><tr><td>-E ERROR message (sent to stderr).</td></tr><tr><td>-W WARNING message (sent to stderr).</td></tr><tr><td>-N NOTICE message.</td></tr><tr><td>-S Sub title message.</td></tr><tr><td>-I Info title message.</td></tr><tr><td>-C Configuration file loading message.</td></tr><tr><td>-R Rule file loading message.</td></tr></table><p>Example: <code class="code">log -I "Info Title message"</code></p></dd><dt><span class="term">create_chain</span></dt><dd><p>Description: Create an iptables chain (add command to the command queue).</p><p>Usage:</p><div class="cmdsynopsis"><p><code class="command">create_chain</code>  {<em class="replaceable"><code>table</code></em>} {<em class="replaceable"><code>chain</code></em>}</p></div><p>Example: <code class="code">create_chain filter FOO</code></p></dd><dt><span class="term">delete_chain</span></dt><dd><p>Description: Delete an iptables chain (add command to the command queue).</p><p>Usage:</p><div class="cmdsynopsis"><p><code class="command">delete_chain</code>  {<em class="replaceable"><code>table</code></em>} {<em class="replaceable"><code>chain</code></em>}</p></div><p>Example: <code class="code">delete_chain filter FOO</code></p></dd><dt><span class="term">set_proc</span></dt><dd><p>Description: Set a configuration value in the `/proc' filesystem (add command to
                the command queue).</p><p>Usage:</p><div class="cmdsynopsis"><p><code class="command">set_proc</code>  {<em class="replaceable"><code>value</code></em>} {<em class="replaceable"><code>path-to-file</code></em>} {<em class="replaceable"><code>message-to-display</code></em>}</p></div><p>Example: <code class="code">set_proc 1 '/proc/sys/net/ipv4/conf/all/log_martians' 'Enabling
                  logging of martians on all interfaces'</code></p></dd><dt><span class="term">log_drop_scans</span></dt><dd><p>Description: Globally LOG and/or DROP (nmap) scans. The following according
                configuration variables can be configured in the main configuration file:</p><table class="simplelist" border="0" summary="Simple list"><tr><td>DROP_Stealth_XMAS</td></tr><tr><td>DROP_Stealth_XMAS_PSH</td></tr><tr><td>DROP_Stealth_XMAS_ALL</td></tr><tr><td>DROP_Stealth_FIN</td></tr><tr><td>DROP_Stealth_SYN_RST</td></tr><tr><td>DROP_Stealth_SYN_FIN</td></tr><tr><td>DROP_Stealth_Null</td></tr><tr><td>LOG_Stealth_XMAS</td></tr><tr><td>LOG_Stealth_XMAS_PSH</td></tr><tr><td>LOG_Stealth_XMAS_ALL</td></tr><tr><td>LOG_Stealth_FIN</td></tr><tr><td>LOG_Stealth_SYN_RST</td></tr><tr><td>LOG_Stealth_SYN_FIN</td></tr><tr><td>LOG_Stealth_Null</td></tr></table><p>Usage: <span class="command"><strong>log_drop_scans</strong></span></p></dd><dt><span class="term">log_fragments</span></dt><dd><p>Log fragments.</p></dd><dt><span class="term">drop_fragments</span></dt><dd><p>Drop fragments.</p></dd><dt><span class="term">log_invalid_state</span></dt><dd><p>Log packets in invalid state.</p></dd><dt><span class="term">drop_invalid_state</span></dt><dd><p>Drop packets in invalid state.</p></dd><dt><span class="term">logdrop_illegal_tcp</span></dt><dd><p>Log and/or drop non legal tcp packets.</p></dd><dt><span class="term">drop_dhcp</span></dt><dd><p>Drop dhcp broadcasts on certain interfaces.</p></dd><dt><span class="term">drop_netbios</span></dt><dd><p>Drop netbios broadcasts on certain interfaces</p></dd><dt><span class="term">drop_upnp</span></dt><dd><p>Drop UPNP broadcasts on certain interfaces</p></dd><dt><span class="term">reject_auth</span></dt><dd><p>Reject auth (tcp port 113) traffic.</p></dd><dt><span class="term">app_allow_wmp</span></dt><dd><p>Allow forwarding of Windows Media Player traffic on certain interfaces.</p></dd><dt><span class="term">app_allow_rmp</span></dt><dd><p>Allow forwarding of Real Media Player traffic on certain interfaces.</p></dd><dt><span class="term">intns_to_extns</span></dt><dd><p>Allow internal DNS servers to communicate with ISP name servers.</p></dd><dt><span class="term">lan_isp_smtp</span></dt><dd><p>Allow local networks to communicate with ISP SMTP servers.</p></dd><dt><span class="term">lan_ftp</span></dt><dd><p>Allow passive and/or active ftp forwarding traffic from certain LANs.</p></dd><dt><span class="term">enable_ipsec</span></dt><dd><p>Enable ipsec rules.</p></dd><dt><span class="term">restrict_output</span></dt><dd><p>Settings to restrict traffic in OUTPUT chain.</p></dd><dt><span class="term">set_ttl</span></dt><dd><p>Manipulate TTL on forwarded packets</p></dd><dt><span class="term">mark_prio_syn</span></dt><dd><p>Prioritize SYN packets.</p></dd><dt><span class="term">mark_out_bulk</span></dt><dd><p>Mark OUTPUT bulk traffic.</p></dd><dt><span class="term">mark_fwd_bulkq</span></dt><dd><p>Mark FORWARD bulk traffic.</p></dd></dl></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="inline_funcs"></a>inline functions</h3></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3296"></a>Rulefile usage guidelines</h3></div></div></div><p></p></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="usage"></a>Chapter&nbsp;5.&nbsp;Usage</h2></div><div><h3 class="subtitle"><i>Running IP-Array</i></h3></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#startup_params">Startup parameters and options</a></span></dt><dd><dl><dt><span class="section"><a href="#usage_params">Parameters</a></span></dt><dt><span class="section"><a href="#usage_options">Options</a></span></dt></dl></dd><dt><span class="section"><a href="#startup_usage_examples">Usage examples</a></span></dt></dl></div><p></p><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="startup_params"></a>Startup parameters and options</h2></div></div></div><p></p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="usage_params"></a>Parameters</h3></div></div></div><p>These parameters control the 'mode' IP-Array runs on.</p><div class="itemizedlist"><ul type="disc"><li><p>start</p><p>All network connections are forbidden until all configuration has been read.
              Module probing (if configured) is done first. After all commands are compiled, they
              are applied at once. An iptables rule listing is saved for later difference
              checks.</p></li><li><p>stop</p><p>All tables and chains get flushed, no firewalling is active any more. All tc qdisc
              are removed, no traffic shaping is active any more. Modules configured to be loaded
              are removed.</p></li><li><p>restart</p><p>Module probing (if configured) is done first. After all commands are compiled,
              they are applied at once. An iptables rule listing is saved for later difference
              checks.</p></li><li><p>test</p><p>Acts like the 'restart', but will use the testing configuration below the 'test'
              folder. Also it will shedule a restore job (using the `at' command sheduler) for the
              time specified with <code class="varname">RELOAD_TIME</code> in the <a class="link" href="#conf_file_defaults" title="Defaults (defaults.conf)">defaults</a> file.</p></li><li><p>open</p><p>Module probing (if configured) is done first.This mode leaves only the NAT rules
              active (reads configuration and re-applies them), all raw, mangle and filter rules are
              deleted. Policies are set to ACCEPT. An iptables rule listing is saved for later
              difference checks.</p></li><li><p>tc-start</p><p>Start traffic shaping only. Mangle table rules will be (re)-applied. An iptables
              rule listing is saved for later difference checks.</p></li><li><p>tc-stop</p><p>Stop traffic shaping only. Mangle table rules will be (re)-applied. Qdisks of
              interfaces listed in <code class="varname">NET_INTERFACES</code> will be deleted. An iptables
              rule listing is saved for later difference checks.</p></li><li><p>lockdown</p><p>All filter table policies will be set to DROP, all others will be set to ACCEPT.
              All chains get flushed and custom chains are deleted. No more network connections are
              allowed except:</p><table class="simplelist" border="0" summary="Simple list"><tr><td>A: If the bash environment variable SSH_CONNECTION is set, IP-Array allow
                  connections from that source address to the ssh server port.</td></tr><tr><td>B: If the environment variable is not set, but the ADMIN_CONNECTION variable
                  is set in the main config file, IP-Array will allow the configured
                  connection.</td></tr><tr><td>C: If the ALLOW_LOOPBACK variable is set in the main config file, loopback
                  communication will be allowed.</td></tr></table></li><li><p>diff-last-activated</p><p>Every time IP-Array is not in 'test' mode and activates an iptables ruleset, it
              saves a listing of the rules to a file. Using this parameter a (simple bash based)
              difference check between the currently active ruleset and the listing of the file is
              performed. Thus allowing to detect (unwanted) modifications.</p></li><li><p>dry-run</p><p>Configuration is processed and validated, but no commands will be applied. </p></li><li><p>save</p><p>The currently active iptables ruleset will be saved using 'iptables-save'.</p></li><li><p>save-known-good</p><p>Save the currently active iptables ruleset to file (the name of the 'known-good'
              script can be set in the <a class="link" href="#conf_file_defaults" title="Defaults (defaults.conf)">defaults</a> file.
              It will be used if <code class="varname">RESTORE_ON_START</code> is set to `1' (quick start
              activated).</p></li><li><p>restore</p><p>The previously saved ruleset (using the 'save' parameter) will be restored using
              'iptables-restore'.</p></li><li><p>save-commands</p><p>Save all commands (modprobe, proc, tc, iptables) to a file.</p></li><li><p>save-iptables-commands</p><p>Save the generated iptables commands to a file.</p></li><li><p>save-modprobe-commands</p><p>Save the generated modprobe commands to a file.</p></li><li><p>save-proc-commands</p><p>Save the generated /proc commands to a file.</p></li><li><p>save-tc-commands</p><p>Save the generated tc commands to file.</p></li><li><p>save-shaping-commands</p><p>Save the generated tc and iptables mangle table (mark) commands to file.</p></li><li><p>prepare-restore-on-start</p><p>Create the '<span class="bold"><strong>quick start</strong></span>' scripts. After the
              configuration is completed this parameter allows to save it into scripts holding the
              compiled commands, in order to quickly (re)apply it to the system. If iptables-save is
              used (<code class="varname">IPTSAVE_FAILS</code> is set to `0') the currently active ruleset
              will be saved. The names for these 'known-good' scripts can be set in the <a class="link" href="#conf_file_defaults" title="Defaults (defaults.conf)">defaults</a> file.</p></li><li><p>parse-xml</p><p>Compile bash scripts from the XML files.</p></li><li><p>version</p><p>Show version information.</p></li><li><p>help, -h, --help, -? [-PF | --public-functions] [name of public-function]</p><p>Show usage information.</p><p>If `--public-functions' is used as second argument, a list of available public
              functions is printed. If a name of public function is given as third argument, a brief
              description of the function is shown.</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="usage_options"></a>Options</h3></div></div></div><p>Options with no further argument are listed first.</p><div class="itemizedlist"><ul type="disc"><li><p>-n, --no-autosave</p><p>Do not use the automatic saving and restoring logic (see <a class="link" href="#autosave" title="Autosave / restore">autosave / restore</a>).</p></li><li><p>-p, --parse-xml</p><p>Read all XML files and overwrite already compiled bash scripts.</p></li><li><p>-pb, --parse-ruleblocks</p><p>Read XML ruleblock files and overwrite already compiled bash scripts.</p></li><li><p>-pr, --parse-rulefiles</p><p>Read XML rule files and overwrite already compiled bash scripts.</p></li><li><p>-pt, --parse-templates</p><p>Read XML template files and overwrite already compiled bash scripts.</p></li><li><p>-b, --base-dir directory</p><p>Set base directory to use (i.e. /etc/ip-array).</p></li><li><p>-c, --config-file file</p><p>Specify the name of the <a class="link" href="#conf_file_main_conf" title="Main configuration file (ip-array.conf)">main configuration
                file</a> to use.</p></li><li><p>-d, --defaults-file full_path_to_file</p><p>Specify the full path the <a class="link" href="#conf_file_defaults" title="Defaults (defaults.conf)">defaults</a>
              file to use.</p></li><li><p>-e, --exe-dir directory</p><p>Set the directory to place the main executable of IP-Array into (i.e.
              /usr/bin/ip-array).</p></li><li><p>-l, --lib-dir directory</p><p>Set the directory to place the function file(s) of IP-Array into (i.e.
              /usr/lib/ip-array).</p></li><li><p>-s, --save-file file</p><p>Specify the name of the file used for saving.</p></li><li><p>-sv, --syslog-verbose 0-5</p><p>Specify the level of output verbosity to syslog. Allowed values are from `0' to
              `5'.</p></li><li><p>-v, --verbose 0-8</p><p>Specify the level of output verbosity. Allowed values are from `0' to `8'.</p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="startup_usage_examples"></a>Usage examples</h2></div></div></div><p>
        </p><div class="variablelist"><dl><dt><span class="term">/etc/init.d/ip-array dry-run -v 6 -sv 0 -pb</span></dt><dd><p>Run IP-Array in no-acting mode (don't apply commands). With a verbosity to
                screen of `6' (quite detailed) and a syslog verbosity of `0'. Also parse the XML
                ruleblock files and compile bash scripts out of them.</p></dd><dt><span class="term">/etc/init.d/ip-array parse-xml -sv 0</span></dt><dd><p>Just parse all XML files. Use the default screen verbosity and set syslog
                verbosity to `0'.</p></dd><dt><span class="term">/etc/init.d/ip-array restart -p -n</span></dt><dd><p>Parse the XML files before reloading the configuration. Do not use the autosave
                / restore logic.</p></dd><dt><span class="term">/etc/init.d/ip-array save -s home_net_config.ipt_save</span></dt><dd><p>Save the currently active iptables ruleset using iptables-save to the file
                specified as 'home_net_config.ipt_save.</p></dd><dt><span class="term">/etc/init.d/ip-array test -d "/etc/default/ip-array/defaults_02.conf" -c
              "xyz_test_02.conf" -sv 4 -v 0 -pb -pr</span></dt><dd><p>Run IP-Array in 'test' mode. Use the defaults config file specified with
                '/etc/default/ip-array/defaults_02.conf'. Use the main configuration file specified
                with: 'xyz_test_02.conf'. Set syslog verbosity to `4'. Set screen output verbosity
                to `0'. Parse ruleblock and rule files.</p></dd><dt><span class="term">/etc/init.d/ip-array prepare-restore-on-start -v 1 -sv 0</span></dt><dd><p>Prepare the 'quick-start' scripts with a screen verbosity of `1' and syslog
                verbosity of `0'.</p></dd></dl></div><p>
      </p></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="examples"></a>Chapter&nbsp;6.&nbsp;Examples</h2></div><div><h3 class="subtitle"><i>Example scenarios</i></h3></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#example_single_host">Single host example</a></span></dt><dt><span class="section"><a href="#example_lan_gatew">LAN gateway example</a></span></dt><dt><span class="section"><a href="#example_multi_home">Multi-homed example</a></span></dt></dl></div><p></p><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="example_single_host"></a>Single host example</h2></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="example_lan_gatew"></a>LAN gateway example</h2></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="example_multi_home"></a>Multi-homed example</h2></div></div></div><p></p></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="faq"></a>Chapter&nbsp;7.&nbsp;FAQ</h2></div><div><h3 class="subtitle"><i>Frequently Asked Questions</i></h3></div></div></div><div class="qandaset"><dl><dt></dt><dd><dl><dt>7.1.1. <a href="#d0e3612">Why the name 'IP-Array'?</a></dt><dt>7.1.2. <a href="#d0e3619">Why a bash script?</a></dt></dl></dd></dl><table border="0" summary="Q and A Set"><col align="left" width="1%"><tbody><tr class="toc"><td align="left" valign="top" colspan="2"><dl><dt>7.1.1. <a href="#d0e3612">Why the name 'IP-Array'?</a></dt><dt>7.1.2. <a href="#d0e3619">Why a bash script?</a></dt></dl></td></tr><tr class="question"><td align="left" valign="top"><a name="d0e3612"></a><a name="d0e3613"></a><p><b>7.1.1.</b></p></td><td align="left" valign="top"><p>Why the name 'IP-Array'?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>IP-Array functionality is built around utilizing 'arrays', hence the name.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="d0e3619"></a><a name="d0e3620"></a><p><b>7.1.2.</b></p></td><td align="left" valign="top"><p>Why a bash script?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><div class="itemizedlist"><ul type="disc"><li><p>I wanted to learn bash. Usually I choose myself a project and then learn while
                  developing - same here.</p></li><li><p>Bash should be installed on every common linux distribution, hence no need for
                  any additional packages.</p></li><li><p>You could say 'there are already a lot of iptables frontends available': Well,
                  actually there are a couple of public bash firewall scripts available. Lots of
                  them are quite unmaintained, or did not quite do what i wanted. Of course there
                  are also accurate and good scripts around, so it's up to the user to decide. Also
                  if you don't want to use any external program for whatever reason, IP-Array might
                  become useful.</p></li></ul></div></td></tr></tbody></table></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="appendix"></a>Chapter&nbsp;8.&nbsp;Appendix</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#support_info">Support</a></span></dt><dt><span class="section"><a href="#bug_report">Bug report</a></span></dt><dt><span class="section"><a href="#co-develop">Co-Development</a></span></dt></dl></div><p></p><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="support_info"></a>Support</h2></div></div></div><p>The preferred way to get support on IP-Array, is to open a forum post on the project
        page. Alternatively you could send a mail at your own risk to AllKind@BonBon.net.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="bug_report"></a>Bug report</h2></div></div></div><p>Please report bugs either via a forum post on the project homepage, or send email to
        AllKind@BonBon.net.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="co-develop"></a>Co-Development</h2></div></div></div><p>If you like IP-Array and want to help developing, see 'Help' section for ways to get in
        contact.</p></div></div></div></body></html>